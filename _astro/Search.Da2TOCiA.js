import{o as le,i as se,I as O,b as G,r as J,h as ie,a as oe}from"./Icon.0FUmJ8Hp.js";import{j as ce,k as P,n as fe,g as p,o as ue,q as de,H as ve,u as K,v as Q,w as V,x as H,C as he,y as pe,z as ge,A as me,B as z,D as te,E as xe,m as F,F as X,G as ae,I as be,J as _e,K as re,L as we,M as ke,N as ye,O as U,P as Ee,Q as Ce,R as Se,S as Te,T as Ie,l as W,a as Le,f as ne,U as Me,e as Z,b as j,p as Ae,h as A,c as Ne,d as N,r as R,t as Re,V as B,i as ee,s as q}from"./render.Bdrl57Cd.js";import{u as $e}from"./url-utils.uEDIkcjJ.js";/* empty css                        */function De(e,t){return t}function Pe(e,t,n){for(var x=[],g=t.length,h=0;h<g;h++)Ce(t[h].e,x,!0);Se(x,()=>{var u=x.length===0&&n!==null;if(u){var a=n,m=a.parentNode;Te(m),m.append(a),e.items.clear(),L(e,t[0].prev,t[g-1].next)}for(var r=0;r<g;r++){var i=t[r];u||(e.items.delete(i.k),L(e,i.prev,i.next)),Ie(i.e,!u)}e.first===t[0]&&(e.first=t[0].prev)})}function qe(e,t,n,x,g,h=null){var u=e,a=new Map,m=null;P&&fe();var r=null,i=ue(()=>{var _=n();return be(_)?_:_==null?[]:ae(_)}),v,b=!0;function C(){Oe(T,v,u,t,x),r!==null&&(v.length===0?(r.fragment?(u.before(r.fragment),r.fragment=null):re(r.effect),l.first=r.effect):we(r.effect,()=>{r=null}))}var l=ce(()=>{v=p(i);var _=v.length;let S=!1;if(P){var E=de(u)===ve;E!==(_===0)&&(u=K(),Q(u),V(!1),S=!0)}for(var M=new Set,I=me,s=null,o=xe(),c=0;c<_;c+=1){P&&H.nodeType===he&&H.data===pe&&(u=H,S=!0,V(!1));var f=v[c],w=x(f,c),d=b?null:a.get(w);d?(ge(d.v,f),d.i=c,o&&I.skipped_effects.delete(d.e)):(d=He(b?u:null,s,f,w,c,g,t,n),b&&(d.o=!0,s===null?m=d:s.next=d,s=d),a.set(w,d)),M.add(w)}if(_===0&&h&&!r)if(b)r={fragment:null,effect:z(()=>h(u))};else{var k=document.createDocumentFragment(),y=te();k.append(y),r={fragment:k,effect:z(()=>h(y))}}if(P&&_>0&&Q(K()),!b)if(o){for(const[$,D]of a)M.has($)||I.skipped_effects.add(D.e);I.oncommit(C),I.ondiscard(()=>{})}else C();S&&V(!0),p(i)}),T={effect:l,items:a,first:m};b=!1,P&&(u=H)}function Oe(e,t,n,x,g){var h=t.length,u=e.items,a=e.first,m,r=null,i=[],v=[],b,C,l,T;for(T=0;T<h;T+=1){if(b=t[T],C=g(b,T),l=u.get(C),e.first??=l,!l.o){l.o=!0;var _=r?r.next:a;L(e,r,l),L(e,l,_),Y(l,_,n),r=l,i=[],v=[],a=r.next;continue}if((l.e.f&U)!==0&&re(l.e),l!==a){if(m!==void 0&&m.has(l)){if(i.length<v.length){var S=v[0],E;r=S.prev;var M=i[0],I=i[i.length-1];for(E=0;E<i.length;E+=1)Y(i[E],S,n);for(E=0;E<v.length;E+=1)m.delete(v[E]);L(e,M.prev,I.next),L(e,r,M),L(e,I,S),a=S,r=I,T-=1,i=[],v=[]}else m.delete(l),Y(l,a,n),L(e,l.prev,l.next),L(e,l,r===null?e.first:r.next),L(e,r,l),r=l;continue}for(i=[],v=[];a!==null&&a.k!==C;)(a.e.f&U)===0&&(m??=new Set).add(a),v.push(a),a=a.next;if(a===null)continue;l=a}i.push(l),r=l,a=l.next}if(a!==null||m!==void 0){for(var s=m===void 0?[]:ae(m);a!==null;)(a.e.f&U)===0&&s.push(a),a=a.next;var o=s.length;if(o>0){var c=null;Pe(e,s,c)}}}function He(e,t,n,x,g,h,u,a){var m=(u&ke)!==0,r=(u&ye)===0,i=m?r?F(n,!1,!1):X(n):n,v=(u&_e)===0?g:X(g),b={i:v,v:i,k:x,a:null,e:null,o:!1,prev:t,next:null};try{if(e===null){var C=document.createDocumentFragment();C.append(e=te())}return b.e=z(()=>h(e,i,v,a)),t!==null&&(t.next=b),b}finally{}}function Y(e,t,n){for(var x=e.next?e.next.e.nodes_start:n,g=t?t.e.nodes_start:n,h=e.e.nodes_start;h!==null&&h!==x;){var u=Ee(h);g.before(h),h=u}}function L(e,t,n){t===null?(e.first=n,e.effect.first=n&&n.e):(t.e.next&&(t.e.next.prev=null),t.next=n,t.e.next=n&&n.e),n===null?e.effect.last=t&&t.e:(n.e.prev&&(n.e.prev.next=null),n.prev=t,n.e.prev=t&&t.e)}var Be=ne(`<a class="transition first-of-type:mt-2 lg:first-of-type:mt-0 group block
       rounded-xl text-lg px-3 py-2 hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)]"><div class="transition text-90 inline-flex font-bold group-hover:text-[var(--primary)]"> <!></div> <div class="transition text-xs text-white mb-1 font-mono"> </div> <div class="transition text-sm text-50"><!></div></a>`),Fe=ne(`<div id="search-bar" class="hidden lg:flex transition-all items-center h-11 mr-2 rounded-lg
      bg-black/[0.04] hover:bg-black/[0.06] focus-within:bg-black/[0.06]
      dark:bg-white/5 dark:hover:bg-white/10 dark:focus-within:bg-white/10
"><!> <input placeholder="搜索" class="transition-all pl-10 text-sm bg-transparent outline-0
         h-full w-40 active:w-60 focus:w-60 text-black/50 dark:text-white/50 svelte-1wah7ro"/></div> <button aria-label="Search Panel" id="search-switch" class="btn-plain scale-animation lg:!hidden rounded-lg w-11 h-11 active:scale-90"><!></button> <div id="search-panel" class="float-panel float-panel-closed search-panel absolute md:w-[30rem]
top-20 left-4 md:left-[unset] right-4 shadow-2xl rounded-2xl p-2 svelte-1wah7ro"><div id="search-bar-inside" class="flex relative lg:hidden transition-all items-center h-11 rounded-xl
      bg-black/[0.04] hover:bg-black/[0.06] focus-within:bg-black/[0.06]
      dark:bg-white/5 dark:hover:bg-white/10 dark:focus-within:bg-white/10
  "><!> <input placeholder="Search" class="pl-10 absolute inset-0 text-sm bg-transparent outline-0
               focus:w-60 text-black/50 dark:text-white/50 svelte-1wah7ro"/></div> <!></div>`,1);function Ge(e,t){Ne(t,!1);let n=F(""),x=F(""),g=F([]),h=[];const u=()=>{document.getElementById("search-panel")?.classList.toggle("float-panel-closed")},a=(s,o)=>{const c=document.getElementById("search-panel");!c||!o||(s?c.classList.remove("float-panel-closed"):c.classList.add("float-panel-closed"))},m=(s,o)=>{if(!o)return s;const c=new RegExp(`(${o})`,"gi");return s.replace(c,"<mark>$1</mark>")},r=async(s,o)=>{if(!s){a(!1,o),q(g,[]);return}try{const c=h.filter(f=>{const w=s.toLowerCase(),d=`${f.title} ${f.description} ${f.content}`.toLowerCase(),k=`/posts/${f.link}`;return d.includes(w)||k.toLowerCase().includes(w)||f.link.toLowerCase().includes(w)}).map(f=>{const w=f.content.toLowerCase(),d=s.toLowerCase(),k=w.indexOf(d);let y="";if(k!==-1){const $=Math.max(0,k-50),D=Math.min(f.content.length,k+100);y=f.content.substring($,D),$>0&&(y="..."+y),D<f.content.length&&(y=y+"...")}else y=f.description||f.content.substring(0,150)+"...";return{url:$e(`/posts/${f.link}/`),meta:{title:f.title},excerpt:m(y,s),urlPath:`/posts/${f.link}`}});q(g,c),a(p(g).length>0,o)}catch(c){console.error("Search error:",c),q(g,[]),a(!1,o)}finally{}};le(async()=>{try{const o=await(await fetch("/rss.xml")).text(),w=new DOMParser().parseFromString(o,"text/xml").querySelectorAll("item");h=Array.from(w).map(d=>{let k="";const y=d.getElementsByTagNameNS("*","encoded")[0]?.textContent||d.querySelector("*|encoded")?.textContent||"";return y&&(k=y.replace(/<[^>]*>/g,"")),{title:d.querySelector("title")?.textContent||"",description:d.querySelector("description")?.textContent||"",content:k,link:d.querySelector("link")?.textContent?.replace(/.*\/posts\/(.*?)\//,"$1")||""}})}catch(s){console.error("Error fetching RSS:",s)}}),W(()=>p(n),()=>{r(p(n),!0)}),W(()=>p(x),()=>{r(p(x),!1)}),Le(),se();var i=Fe(),v=Me(i),b=N(v);O(b,{icon:"material-symbols:search",class:"absolute text-[1.25rem] pointer-events-none ml-3 transition my-auto text-black/30 dark:text-white/30"});var C=A(b,2);J(C),R(v);var l=A(v,2),T=N(l);O(T,{icon:"material-symbols:search",class:"text-[1.25rem]"}),R(l);var _=A(l,2),S=N(_),E=N(S);O(E,{icon:"material-symbols:search",class:"absolute text-[1.25rem] pointer-events-none ml-3 transition my-auto text-black/30 dark:text-white/30"});var M=A(E,2);J(M),R(S);var I=A(S,2);qe(I,1,()=>p(g),De,(s,o)=>{var c=Be(),f=N(c),w=N(f,!0),d=A(w);O(d,{icon:"fa6-solid:chevron-right",class:"transition text-[0.75rem] translate-x-1 my-auto text-[var(--primary)]"}),R(f);var k=A(f,2),y=N(k,!0);R(k);var $=A(k,2),D=N($);ie(D,()=>(p(o),B(()=>p(o).excerpt))),R($),R(c),Re(()=>{oe(c,"href",(p(o),B(()=>p(o).url))),ee(w,(p(o),B(()=>p(o).meta.title))),ee(y,(p(o),B(()=>p(o).urlPath)))}),j(s,c)}),R(_),G(C,()=>p(n),s=>q(n,s)),Z("focus",C,()=>r(p(n),!0)),Z("click",l,u),G(M,()=>p(x),s=>q(x,s)),j(e,i),Ae()}export{Ge as default};
